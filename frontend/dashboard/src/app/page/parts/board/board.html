<div class="board-container">
  <div class="board-grid" [style.grid]="getGridTemplate()">
    @for (slotIndex of slots(); track slotIndex) {
      <div
        class="board-slot"
        [style.grid-area]="getSlotGridArea(slotIndex)"
        (click)="onSlotClick(slotIndex)"
      >
        @if (layoutService.getGraphAtSlot(slotIndex)) {
          <!-- グラフが配置されている場合、テンプレートをレンダリング -->
          @if (getTemplateForSlot(slotIndex); as template) {
            <div class="graph-wrapper">
              <ng-container *ngTemplateOutlet="template"></ng-container>
            </div>
          }
        } @else {
          <!-- 空のスロット -->
          <div class="empty-slot">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
              <circle cx="24" cy="24" r="22" stroke="currentColor" stroke-width="2" stroke-dasharray="4 4"/>
              <path d="M24 16V32M16 24H32" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <span class="empty-slot-text">クリックしてグラフを追加</span>
          </div>
        }
      </div>
    }
  </div>
</div>

<!-- グラフ選択モーダル -->
@if (isGraphSelectorOpen()) {
  <app-graph-selector
    [category]="currentCategory()"
    (onClose)="closeGraphSelector()"
    (onSelect)="onGraphSelect($event)"
  />
}
